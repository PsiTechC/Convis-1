redis uses an image, skipping
nginx uses an image, skipping
Building api
#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.81kB done
#1 WARN: FromAsCasing: 'as' and 'FROM' keywords' casing do not match (line 2)
#1 WARN: FromAsCasing: 'as' and 'FROM' keywords' casing do not match (line 11)
#1 WARN: FromAsCasing: 'as' and 'FROM' keywords' casing do not match (line 32)
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.11-slim
#2 ...

#3 [auth] library/python:pull token for registry-1.docker.io
#3 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.11-slim
#2 DONE 3.0s

#4 [internal] load .dockerignore
#4 transferring context: 656B 0.0s done
#4 DONE 0.0s

#5 [base 1/1] FROM docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617
#5 resolve docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617 0.0s done
#5 DONE 0.0s

#6 [production 1/6] RUN apt-get update && apt-get install -y --no-install-recommends     curl     tesseract-ocr     tesseract-ocr-eng     libgl1     libglib2.0-0     && rm -rf /var/lib/apt/lists/*
#6 CACHED

#7 [production 2/6] WORKDIR /app
#7 CACHED

#8 [internal] load build context
#8 transferring context: 1.87MB 0.0s done
#8 DONE 0.1s

#9 [builder 1/4] RUN apt-get update && apt-get install -y --no-install-recommends     build-essential     curl     tesseract-ocr     tesseract-ocr-eng     libgl1     libglib2.0-0     && rm -rf /var/lib/apt/lists/*
#9 CACHED

#10 [builder 2/4] WORKDIR /app
#10 CACHED

#11 [builder 3/4] COPY requirements.txt .
#11 CACHED

#12 [builder 4/4] RUN pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt
#12 CACHED

#13 [production 3/6] COPY --from=builder /usr/local/lib/python3.11/site-packages /usr/local/lib/python3.11/site-packages
#13 DONE 33.1s

#14 [production 4/6] COPY --from=builder /usr/local/bin /usr/local/bin
#14 DONE 0.5s

#15 [production 5/6] COPY . .
#15 DONE 0.1s

#16 [production 6/6] RUN mkdir -p uploads/knowledge_base chroma_db logs &&     chmod -R 755 uploads chroma_db logs
#16 DONE 0.2s

#17 exporting to image
#17 exporting layers
#17 exporting layers 229.7s done
#17 exporting manifest sha256:95b87022bf81f1c3287a661694bafa9be62aab75edfb78a829520d0682c894a9 done
#17 exporting config sha256:7c54f3b98a0033bc0120468fd4d9302693818543d15e77ab23333a3b1922748e done
#17 exporting attestation manifest sha256:86a9aefb243c8517d9b283bd9bf2ce2dc8f6ca456efa3078ad06d6e296ebdd06 0.0s done
#17 exporting manifest list sha256:61a2c869b69734ebc83d57c89199a3e830c38abc125d85baf7c71829fd025be2 done
#17 naming to docker.io/library/convis-main_api:latest done
#17 unpacking to docker.io/library/convis-main_api:latest 0.1s done
#17 DONE 229.9s

 [33m3 warnings found (use docker --debug to expand):
[0m - FromAsCasing: 'as' and 'FROM' keywords' casing do not match (line 2)
 - FromAsCasing: 'as' and 'FROM' keywords' casing do not match (line 11)
 - FromAsCasing: 'as' and 'FROM' keywords' casing do not match (line 32)

View build details: docker-desktop://dashboard/build/desktop-linux/desktop-linux/a5wru1y2fyk831cs21y69r8us
Building web
#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.42kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/node:18-alpine
#2 ...

#3 [auth] library/node:pull token for registry-1.docker.io
#3 DONE 0.0s

#2 [internal] load metadata for docker.io/library/node:18-alpine
#2 DONE 4.3s

#4 [internal] load .dockerignore
#4 transferring context: 532B 0.0s done
#4 DONE 0.0s

#5 [base 1/1] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 resolve docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e 0.0s done
#5 ...

#6 [internal] load build context
#6 transferring context: 871.89kB 0.0s done
#6 DONE 0.0s

#5 [base 1/1] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 sha256:25ff2da83641908f65c3a74d80409d6b1b62ccfaab220b9ea70b80df5a2e0549 0B / 446B 0.2s
#5 sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 0B / 1.26MB 0.2s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 0B / 40.01MB 0.2s
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 0B / 3.64MB 0.2s
#5 sha256:25ff2da83641908f65c3a74d80409d6b1b62ccfaab220b9ea70b80df5a2e0549 446B / 446B 0.6s done
#5 sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 1.05MB / 1.26MB 1.1s
#5 sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 1.26MB / 1.26MB 1.1s done
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 2.10MB / 40.01MB 1.5s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 4.19MB / 40.01MB 1.8s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 6.29MB / 40.01MB 2.0s
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 1.05MB / 3.64MB 2.0s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 9.44MB / 40.01MB 2.3s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 11.53MB / 40.01MB 2.6s
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 2.10MB / 3.64MB 2.6s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 13.63MB / 40.01MB 2.9s
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 3.64MB / 3.64MB 3.1s done
#5 extracting sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 15.73MB / 40.01MB 3.3s
#5 extracting sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 0.1s done
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 17.83MB / 40.01MB 3.5s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 19.92MB / 40.01MB 3.8s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 22.02MB / 40.01MB 4.1s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 24.12MB / 40.01MB 4.4s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 26.21MB / 40.01MB 4.7s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 28.31MB / 40.01MB 4.8s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 30.41MB / 40.01MB 5.1s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 32.51MB / 40.01MB 5.3s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 34.60MB / 40.01MB 5.4s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 36.70MB / 40.01MB 5.7s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 40.01MB / 40.01MB 6.0s done
#5 extracting sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e
#5 extracting sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 0.8s done
#5 DONE 6.9s

#5 [base 1/1] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 extracting sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 0.0s done
#5 extracting sha256:25ff2da83641908f65c3a74d80409d6b1b62ccfaab220b9ea70b80df5a2e0549 0.0s done
#5 DONE 7.0s

#7 [builder 1/4] WORKDIR /app
#7 DONE 0.1s

#8 [deps 1/4] RUN apk add --no-cache libc6-compat
#8 0.244 fetch https://dl-cdn.alpinelinux.org/alpine/v3.21/main/x86_64/APKINDEX.tar.gz
#8 ...

#9 [runner 2/8] RUN addgroup --system --gid 1001 nodejs
#9 DONE 0.2s

#8 [deps 1/4] RUN apk add --no-cache libc6-compat
#8 0.361 fetch https://dl-cdn.alpinelinux.org/alpine/v3.21/community/x86_64/APKINDEX.tar.gz
#8 ...

#10 [runner 3/8] RUN adduser --system --uid 1001 nextjs
#10 DONE 0.2s

#8 [deps 1/4] RUN apk add --no-cache libc6-compat
#8 0.671 (1/3) Installing musl-obstack (1.2.3-r2)
#8 0.683 (2/3) Installing libucontext (1.3.2-r0)
#8 0.690 (3/3) Installing gcompat (1.1.0-r4)
#8 0.704 OK: 10 MiB in 20 packages
#8 DONE 0.8s

#11 [deps 2/4] WORKDIR /app
#11 DONE 0.0s

#12 [deps 3/4] COPY package.json package-lock.json ./
#12 DONE 0.0s

#13 [deps 4/4] RUN npm ci
#13 16.56 
#13 16.56 added 378 packages, and audited 379 packages in 16s
#13 16.56 
#13 16.56 140 packages are looking for funding
#13 16.56   run `npm fund` for details
#13 16.56 
#13 16.56 found 0 vulnerabilities
#13 16.56 npm notice
#13 16.56 npm notice New major version of npm available! 10.8.2 -> 11.6.2
#13 16.56 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.6.2
#13 16.56 npm notice To update run: npm install -g npm@11.6.2
#13 16.56 npm notice
#13 DONE 16.7s

#14 [builder 2/4] COPY --from=deps /app/node_modules ./node_modules
#14 DONE 5.1s

#15 [builder 3/4] COPY . .
#15 DONE 0.2s

#16 [builder 4/4] RUN NEXT_PUBLIC_API_URL=http://api:8000 npm run build
#16 0.503 
#16 0.503 > convis-web@0.1.0 build
#16 0.503 > next build --turbopack
#16 0.503 
#16 1.458    â–² Next.js 15.5.4 (Turbopack)
#16 1.458 
#16 1.488    Creating an optimized production build ...
#16 11.67  âœ“ Finished writing to disk in 28ms
#16 11.69  âœ“ Compiled successfully in 9.5s
#16 11.70    Skipping validation of types
#16 11.70    Skipping linting
#16 11.96    Collecting page data ...
#16 13.04    Generating static pages (0/15) ...
#16 13.74  â¨¯ useSearchParams() should be wrapped in a suspense boundary at page "/auth/callback". Read more: https://nextjs.org/docs/messages/missing-suspense-with-csr-bailout
#16 13.74     at g (/app/.next/server/chunks/ssr/node_modules_next_dist_042de4b7._.js:4:5016)
#16 13.74     at m (/app/.next/server/chunks/ssr/node_modules_next_dist_042de4b7._.js:4:6650)
#16 13.74     at e (/app/.next/server/chunks/ssr/[root-of-the-server]__12694171._.js:1:1372)
#16 13.74     at n3 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:82831)
#16 13.74     at n6 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:84601)
#16 13.74     at n5 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:104801)
#16 13.74     at n7 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:102219)
#16 13.74     at n8 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:83183)
#16 13.74     at n6 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:84647)
#16 13.74     at n6 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:101560)
#16 13.74 Error occurred prerendering page "/auth/callback". Read more: https://nextjs.org/docs/messages/prerender-error
#16 13.74 Export encountered an error on /auth/callback/page: /auth/callback, exiting the build.
#16 13.78  â¨¯ Next.js build worker exited with code: 1 and signal: null
#16 13.83 npm notice
#16 13.83 npm notice New major version of npm available! 10.8.2 -> 11.6.2
#16 13.83 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.6.2
#16 13.83 npm notice To update run: npm install -g npm@11.6.2
#16 13.83 npm notice
#16 ERROR: process "/bin/sh -c NEXT_PUBLIC_API_URL=http://api:8000 npm run build" did not complete successfully: exit code: 1
------
 > [builder 4/4] RUN NEXT_PUBLIC_API_URL=http://api:8000 npm run build:
13.74     at n6 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:84647)
13.74     at n6 (/app/node_modules/next/dist/compiled/next-server/app-page-turbo.runtime.prod.js:2:101560)
13.74 Error occurred prerendering page "/auth/callback". Read more: https://nextjs.org/docs/messages/prerender-error
13.74 Export encountered an error on /auth/callback/page: /auth/callback, exiting the build.
13.78  â¨¯ Next.js build worker exited with code: 1 and signal: null
13.83 npm notice
13.83 npm notice New major version of npm available! 10.8.2 -> 11.6.2
13.83 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.6.2
13.83 npm notice To update run: npm install -g npm@11.6.2
13.83 npm notice
------
Dockerfile:25
--------------------
  23 |     
  24 |     # Build the application
  25 | >>> RUN NEXT_PUBLIC_API_URL=http://api:8000 npm run build
  26 |     
  27 |     # Production image, copy all the files and run next
--------------------
ERROR: failed to build: failed to solve: process "/bin/sh -c NEXT_PUBLIC_API_URL=http://api:8000 npm run build" did not complete successfully: exit code: 1

View build details: docker-desktop://dashboard/build/desktop-linux/desktop-linux/6y2asakd0ss7i98a8y02annc8
Service 'web' failed to build : Build failed
